<div class="modal-header pb-0">
    <div class="row flex-grow-1">
        <div class="col-12">
            <div class="card">
                <div class="card-body p-2">
                    <form class="d-flex flex-grow-1 align-items-center">
                        <input
                            type="text" class="form-control form-control pe-0 border-0 shadow-none" placeholder="Buscar carta..." 
                            [formControl]="cardSearchTextInput"
                            (input)="doCardSearch()"
                        >
                        <button type="button" class="btn border-none" (click)="toggleBusquedaAvanzada()">
                            <fa-icon [icon]="filetersIcon" style="fill-opacity: .5;"></fa-icon>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal-body pb-0">
    @if (mostrarBusquedaAvanzada) {
        <form [formGroup]="form">
            <app-card-search-filters></app-card-search-filters>
        </form>
}
    @if (cards$ | async; as cards) {
        <div class="list-group">
            @for (card of cards; track $index) {
                <button type="button" class="list-group-item list-group-item-action" [class.active]="isSelectedCard(card)" (click)="toggleSelection(card)" [style.background-image]="getBackgroundImage(card)">
                    <div class="d-flex flex-row align-items-center">
                        <div class="col d-flex flex-column text-truncate">
                            <ngb-highlight [result]="card.name" [term]="term" class="text-truncate"></ngb-highlight>
                            <small class="text-truncate">{{card['expansion_name']}}</small>
                            <small class="text-truncate">{{card.code.default}}</small>
                        </div>
                    </div>
                </button>
            }
            @empty {
                    @if(term && !searching) {
                        <div class="alert alert-warning d-flex flex-row align-items-center justify-content-center m-0">
                            <fa-icon [icon]="warningIcon" class="me-3"/>
                            <span>
                                No se han encontrado resultados
                            </span>
                        </div>
                    }
            }
        </div>
    }
</div>
<div class="modal-footer bg-body justify-content-center border-top">
    <p>Cartas seleccionadas: {{ this.selectedCards.length }}</p>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="activeModal.close('cancel')">Cancelar</button>
    @if (isUpdateMode) {
        <button type="button" class="btn btn-primary" (click)="add()" [disabled]="noCards">Agregar</button>
    }
    @else {
        <button type="button" class="btn btn-success" (click)="create()" [disabled]="noCards">Calcular</button>
    }
</div>


